<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guide · Simulation of MNNs</title><meta name="title" content="Guide · Simulation of MNNs"/><meta property="og:title" content="Guide · Simulation of MNNs"/><meta property="twitter:title" content="Guide · Simulation of MNNs"/><meta name="description" content="Documentation for Simulation of MNNs."/><meta property="og:description" content="Documentation for Simulation of MNNs."/><meta property="twitter:description" content="Documentation for Simulation of MNNs."/><meta property="og:url" content="https://Alexander-Reimer.github.io/Simulation-of-MNNs/man/guide/"/><meta property="twitter:url" content="https://Alexander-Reimer.github.io/Simulation-of-MNNs/man/guide/"/><link rel="canonical" href="https://Alexander-Reimer.github.io/Simulation-of-MNNs/man/guide/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Simulation of MNNs</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Guide</a><ul class="internal"><li><a class="tocitem" href="#Installation-and-Setup"><span>Installation &amp; Setup</span></a></li><li><a class="tocitem" href="#Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour"><span>Usage Example – Simulating &amp; Optimizing a Deformation Behaviour</span></a></li></ul></li><li><a class="tocitem" href="../customize-simulation/">Adding Your Own Simulation</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../lib/public/">Public API</a></li><li><a class="tocitem" href="../../lib/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Alexander-Reimer/Simulation-of-MNNs" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Alexander-Reimer/Simulation-of-MNNs/blob/main/docs/src/man/guide.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Guide"><a class="docs-heading-anchor" href="#Guide">Guide</a><a id="Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Guide" title="Permalink"></a></h1><h2 id="Installation-and-Setup"><a class="docs-heading-anchor" href="#Installation-and-Setup">Installation &amp; Setup</a><a id="Installation-and-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Installation-and-Setup" title="Permalink"></a></h2><p>As it is still in development, this package is not available in the General Registry yet. You can still install the latest version using the Julia package manager with</p><pre><code class="language-julia hljs">julia&gt; # type ] to open package manager

pkg&gt; add https://github.com/Alexander-Reimer/Simulation-of-MNNs</code></pre><p>This should install the MNN package and all dependencies automatically.</p><h3 id="NixOS"><a class="docs-heading-anchor" href="#NixOS">NixOS</a><a id="NixOS-1"></a><a class="docs-heading-anchor-permalink" href="#NixOS" title="Permalink"></a></h3><p>When using NixOS, activating the development shell is necessary to make GLMakie and consequently the visualization of MNNs / graphs / ... possible:</p><pre><code class="language-bash hljs">cd /path/to/this/project
nix-shell .</code></pre><p>This will load the configuration in default.nix.</p><h2 id="Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour"><a class="docs-heading-anchor" href="#Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour">Usage Example – Simulating &amp; Optimizing a Deformation Behaviour</a><a id="Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour" title="Permalink"></a></h2><p><strong>Load MNN library:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using MNN</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><strong>Create a new MNN:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; net = TestNetwork(5, 4) # 5 columns, 4 rows</code><code class="nohighlight hljs ansi" style="display:block;">TestNetwork(Meta graph based on a Graphs.SimpleGraphs.SimpleGraph{Int64} with vertex labels of type Int64, vertex metadata of type MNN.Neuron, edge metadata of type MNN.Spring, graph metadata given by &quot;Simulation&quot;, and default weight 1.0, 4, [3, 4, 3, 4, 3], Bool[0, 1, 0, 1, 0], 5, 17, 1.0, 3.4641016151377544, Dict{Int64, Vector{Number}}(5 =&gt; [1.0, 3.4641016151377544], 16 =&gt; [4.0, 5.196152422706632], 12 =&gt; [3.0, 3.4641016151377544], 8 =&gt; [2.0, 1.7320508075688772], 17 =&gt; [4.0, 8.660254037844386], 1 =&gt; [0.0, 1.7320508075688772], 6 =&gt; [1.0, 6.928203230275509], 11 =&gt; [3.0, 0.0], 9 =&gt; [2.0, 5.196152422706632], 14 =&gt; [3.0, 10.392304845413264]…), [0.0 0.0 … 4.0 4.0; 1.7320508075688772 5.196152422706632 … 5.196152422706632 8.660254037844386], [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0])</code></pre><p><strong>Create a deformation behaviour using a GUI:</strong></p><pre><code class="language-julia hljs">b = get_user_behaviour(net)</code></pre><p><img src="../DeformationGUI.png" alt="Screenshot of the GUI showing a MNN"/></p><ol><li>Left-click a neuron in first or last column and then release the mouse button to select it</li><li>If you move your mouse, you should see a blue (force vector applied to neuron) or red (goal position) arrow. Click again to save / select the current arrow for this neuron.</li></ol><p><strong>Or create a random deformation behaviour:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; b = create_deformation_behaviours(net, 1)[1]</code><code class="nohighlight hljs ansi" style="display:block;">MNN.Deformation(Dict{Int64, Vector{Number}}(15 =&gt; [0.3025607099234905, 0.16142535168476801], 16 =&gt; [-0.15248661383923434, 0.2781487141858242], 17 =&gt; [-0.3031678143123898, -0.061941962381140137]), true, Dict{Int64, Vector{Number}}(2 =&gt; [-0.006283480406257192, -0.038596303888500993], 3 =&gt; [0.03270978423950576, -0.010420372656952882], 1 =&gt; [0.015481499135407684, -0.007248727778316578]))</code></pre><p><strong>Show MNN and created behaviour:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; vis = Visualizer(net, behaviour=b)</code><code class="nohighlight hljs ansi" style="display:block;">Visualizer(Observable([0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 3.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0]), Observable([1.7320508075688772, 5.196152422706632, 8.660254037844386, 0.0, 3.4641016151377544, 6.928203230275509, 10.392304845413264, 1.7320508075688772, 5.196152422706632, 8.660254037844386, 0.0, 3.4641016151377544, 6.928203230275509, 10.392304845413264, 1.7320508075688772, 5.196152422706632, 8.660254037844386]), Tuple[(12, 15), (6, 10), (2, 5), (3, 7), (8, 15), (8, 12), (14, 17), (1, 4), (5, 9), (2, 6)  …  (10, 17), (13, 17), (5, 8), (10, 13), (10, 14), (3, 6), (5, 12), (13, 16), (1, 8), (2, 9)], Dict{Any, Observables.Observable}((10, 17, :ys) =&gt; Observable([8.660254037844386, 8.660254037844386]), (3, 10, :xs) =&gt; Observable([0.0, 2.0]), (6, 13, :xs) =&gt; Observable([1.0, 3.0]), (11, 15, :xs) =&gt; Observable([3.0, 4.0]), (5, 12, :ys) =&gt; Observable([3.4641016151377544, 3.4641016151377544]), (5, 8, :xs) =&gt; Observable([1.0, 2.0]), (1, 4, :ys) =&gt; Observable([1.7320508075688772, 0.0]), (5, 9, :ys) =&gt; Observable([3.4641016151377544, 5.196152422706632]), (2, 6, :ys) =&gt; Observable([5.196152422706632, 6.928203230275509]), (3, 6, :xs) =&gt; Observable([0.0, 1.0])…), Scene (1920px, 1080px):
  0 Plots
  1 Child Scene:
    └ Scene (1920px, 1080px), Axis (44 plots))</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><img src="../usageA_Visualization.svg" alt="Visualization of the MNN with the behaviours."/></p><p><strong>Simulate the behaviour:</strong></p><p>Keep the window of the last step open, then execute</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulate!(net, SecondOrderDiff(500), b, vis=vis)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching Float64(::ForwardDiff.Dual{ForwardDiff.Tag{DiffEqBase.OrdinaryDiffEqTag, Float64}, Float64, 12})
The type `Float64` exists, but no method is defined for this combination of argument types when trying to construct it.

Closest candidates are:
  (::Type{T})(::Real, <span class="sgr91">::RoundingMode</span>) where T&lt;:AbstractFloat
<span class="sgr90">   @</span> <span class="sgr90">Base</span> <span class="sgr90"><span class="sgr4">rounding.jl:265</span></span>
  (::Type{T})(::T) where T&lt;:Number
<span class="sgr90">   @</span> <span class="sgr90">Core</span> <span class="sgr90"><span class="sgr4">boot.jl:900</span></span>
  Float64(<span class="sgr91">::IrrationalConstants.Logten</span>)
<span class="sgr90">   @</span> <span class="sgr35">IrrationalConstants</span> <span class="sgr90">~/.julia/packages/IrrationalConstants/vp5v4/src/<span class="sgr4">macro.jl:112</span></span>
  ...</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><video src="../usageA_simulationBefore.mp4" controls="true" title="Video of the MNN being simulated with forces given in behaviour being applied. The end positions don&#39;t fit to the given goals."><a href="../usageA_simulationBefore.mp4">Video of the MNN being simulated with forces given in behaviour being applied. The end positions don&#39;t fit to the given goals.</a></video></p><p>You should now see the mass points (&quot;neurons&quot;) of the network settling into new stable positions according to the random spring constants set when you created the MNN and the forces randomly generated or set by you. This may take a while the first time because of precompilation, but should then be very fast in the same Julia session.</p><p>It should also be obvious that the neurons in the last column are far away from the set goal (except if you got really, really, really lucky).</p><p><strong>Creating a trainer:</strong></p><p>To optimize the spring constants, we need a <code>Trainer</code> object:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; t = Trainer([b], SecondOrderDiff(500), PPS())</code><code class="nohighlight hljs ansi" style="display:block;">Trainer(MNN.Deformation[MNN.Deformation(Dict{Int64, Vector{Number}}(15 =&gt; [0.3025607099234905, 0.16142535168476801], 16 =&gt; [-0.15248661383923434, 0.2781487141858242], 17 =&gt; [-0.3031678143123898, -0.061941962381140137]), true, Dict{Int64, Vector{Number}}(2 =&gt; [-0.006283480406257192, -0.038596303888500993], 3 =&gt; [0.03270978423950576, -0.010420372656952882], 1 =&gt; [0.015481499135407684, -0.007248727778316578]))], SecondOrderDiff(500, MNN.var&quot;#29#30&quot;()), PPS(false, 1.15, 1.0, Set{Any}(), 250))</code></pre><p><strong>Training:</strong></p><p>Now we train for 500 Epochs:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; train!(net, 500, t)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching Float64(::ForwardDiff.Dual{ForwardDiff.Tag{DiffEqBase.OrdinaryDiffEqTag, Float64}, Float64, 12})
The type `Float64` exists, but no method is defined for this combination of argument types when trying to construct it.

Closest candidates are:
  (::Type{T})(::Real, <span class="sgr91">::RoundingMode</span>) where T&lt;:AbstractFloat
<span class="sgr90">   @</span> <span class="sgr90">Base</span> <span class="sgr90"><span class="sgr4">rounding.jl:265</span></span>
  (::Type{T})(::T) where T&lt;:Number
<span class="sgr90">   @</span> <span class="sgr90">Core</span> <span class="sgr90"><span class="sgr4">boot.jl:900</span></span>
  Float64(<span class="sgr91">::IrrationalConstants.Logten</span>)
<span class="sgr90">   @</span> <span class="sgr35">IrrationalConstants</span> <span class="sgr90">~/.julia/packages/IrrationalConstants/vp5v4/src/<span class="sgr4">macro.jl:112</span></span>
  ...</code></pre><p>Ideally, the base loss (the best loss so far) will decrease significantly.</p><p>If it hasn&#39;t, try executing the previous command again to train the MNN more.</p><p>If that still doesn&#39;t get satisfactory results, then maybe the goals and/or forces you set using the GUI were too large.</p><p><strong>Testing:</strong></p><p>Now check if the MNN fits the given shape morphing behaviour better:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; vis = Visualizer(net, behaviour=b); # update visualization of spring constants</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; reset!(net, vis=vis) # reset neuron positions</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulate!(net, SecondOrderDiff(500), b, vis=vis)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching Float64(::ForwardDiff.Dual{ForwardDiff.Tag{DiffEqBase.OrdinaryDiffEqTag, Float64}, Float64, 12})
The type `Float64` exists, but no method is defined for this combination of argument types when trying to construct it.

Closest candidates are:
  (::Type{T})(::Real, <span class="sgr91">::RoundingMode</span>) where T&lt;:AbstractFloat
<span class="sgr90">   @</span> <span class="sgr90">Base</span> <span class="sgr90"><span class="sgr4">rounding.jl:265</span></span>
  (::Type{T})(::T) where T&lt;:Number
<span class="sgr90">   @</span> <span class="sgr90">Core</span> <span class="sgr90"><span class="sgr4">boot.jl:900</span></span>
  Float64(<span class="sgr91">::IrrationalConstants.Logten</span>)
<span class="sgr90">   @</span> <span class="sgr35">IrrationalConstants</span> <span class="sgr90">~/.julia/packages/IrrationalConstants/vp5v4/src/<span class="sgr4">macro.jl:112</span></span>
  ...</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><video src="../usageA_simulationAfter.mp4" controls="true" title="Video of the MNN being simulated with forces given in behaviour being applied. The end positions now fit much better to the given goals."><a href="../usageA_simulationAfter.mp4">Video of the MNN being simulated with forces given in behaviour being applied. The end positions now fit much better to the given goals.</a></video></p><p>As you can (hopefully) see, the end positions of the neurons now fit much better. The values of the spring constants probably also changed significantly. You can see this by looking at the colors of the springs (lines between neurons): Red means positive spring constant and blue means negative constant.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../customize-simulation/">Adding Your Own Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 16 January 2025 17:02">Thursday 16 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
