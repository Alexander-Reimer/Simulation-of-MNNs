<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guide · Simulation of MNNs</title><meta name="title" content="Guide · Simulation of MNNs"/><meta property="og:title" content="Guide · Simulation of MNNs"/><meta property="twitter:title" content="Guide · Simulation of MNNs"/><meta name="description" content="Documentation for Simulation of MNNs."/><meta property="og:description" content="Documentation for Simulation of MNNs."/><meta property="twitter:description" content="Documentation for Simulation of MNNs."/><meta property="og:url" content="https://Alexander-Reimer.github.io/Simulation-of-MNNs/man/guide/"/><meta property="twitter:url" content="https://Alexander-Reimer.github.io/Simulation-of-MNNs/man/guide/"/><link rel="canonical" href="https://Alexander-Reimer.github.io/Simulation-of-MNNs/man/guide/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Simulation of MNNs</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Guide</a><ul class="internal"><li><a class="tocitem" href="#Installation-and-Setup"><span>Installation &amp; Setup</span></a></li><li><a class="tocitem" href="#Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour"><span>Usage Example – Simulating &amp; Optimizing a Deformation Behaviour</span></a></li></ul></li><li><a class="tocitem" href="../customize-simulation/">Adding Your Own Simulation</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../lib/public/">Public API</a></li><li><a class="tocitem" href="../../lib/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Alexander-Reimer/Simulation-of-MNNs" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Alexander-Reimer/Simulation-of-MNNs/blob/main/docs/src/man/guide.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Guide"><a class="docs-heading-anchor" href="#Guide">Guide</a><a id="Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Guide" title="Permalink"></a></h1><h2 id="Installation-and-Setup"><a class="docs-heading-anchor" href="#Installation-and-Setup">Installation &amp; Setup</a><a id="Installation-and-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Installation-and-Setup" title="Permalink"></a></h2><p>As it is still in development, this package is not available in the General Registry yet. You can still install the latest version using the Julia package manager with</p><pre><code class="language-julia hljs">julia&gt; # type ] to open package manager

pkg&gt; add https://github.com/Alexander-Reimer/Simulation-of-MNNs</code></pre><p>This should install the MNN package and all dependencies automatically.</p><h3 id="NixOS"><a class="docs-heading-anchor" href="#NixOS">NixOS</a><a id="NixOS-1"></a><a class="docs-heading-anchor-permalink" href="#NixOS" title="Permalink"></a></h3><p>When using NixOS, activating the development shell is necessary to make GLMakie and consequently the visualization of MNNs / graphs / ... possible:</p><pre><code class="language-bash hljs">cd /path/to/this/project
nix-shell .</code></pre><p>This will load the configuration in default.nix.</p><h2 id="Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour"><a class="docs-heading-anchor" href="#Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour">Usage Example – Simulating &amp; Optimizing a Deformation Behaviour</a><a id="Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Example-–-Simulating-and-Optimizing-a-Deformation-Behaviour" title="Permalink"></a></h2><p><strong>Load MNN library:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using MNN</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><strong>Create a new MNN:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; net = TestNetwork(5, 4) # 5 columns, 4 rows</code><code class="nohighlight hljs ansi" style="display:block;">TestNetwork(Meta graph based on a Graphs.SimpleGraphs.SimpleGraph{Int64} with vertex labels of type Int64, vertex metadata of type MNN.Neuron, edge metadata of type MNN.Spring, graph metadata given by &quot;Simulation&quot;, and default weight 1.0, 4, [3, 4, 3, 4, 3], Bool[0, 1, 0, 1, 0], 5, 17, 1.0, 3.4641016151377544, Dict{Int64, Vector{Number}}(5 =&gt; [1.0, 3.4641016151377544], 16 =&gt; [4.0, 5.196152422706632], 12 =&gt; [3.0, 3.4641016151377544], 8 =&gt; [2.0, 1.7320508075688772], 17 =&gt; [4.0, 8.660254037844386], 1 =&gt; [0.0, 1.7320508075688772], 6 =&gt; [1.0, 6.928203230275509], 11 =&gt; [3.0, 0.0], 9 =&gt; [2.0, 5.196152422706632], 14 =&gt; [3.0, 10.392304845413264]…), [0.0 0.0 … 4.0 4.0; 1.7320508075688772 5.196152422706632 … 5.196152422706632 8.660254037844386], [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0])</code></pre><p><strong>Create a deformation behaviour using a GUI:</strong></p><pre><code class="language-julia hljs">b = get_user_behaviour(net)</code></pre><p><img src="../DeformationGUI.png" alt="Screenshot of the GUI showing a MNN"/></p><ol><li>Left-click a neuron in first or last column and then release the mouse button to select it</li><li>If you move your mouse, you should see a blue (force vector applied to neuron) or red (goal position) arrow. Click again to save / select the current arrow for this neuron.</li></ol><p><strong>Or create a random deformation behaviour:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; b = create_deformation_behaviours(net, 1)[1]</code><code class="nohighlight hljs ansi" style="display:block;">MNN.Deformation(Dict{Int64, Vector{Number}}(15 =&gt; [0.3025607099234905, 0.16142535168476801], 16 =&gt; [-0.15248661383923434, 0.2781487141858242], 17 =&gt; [-0.3031678143123898, -0.061941962381140137]), true, Dict{Int64, Vector{Number}}(2 =&gt; [-0.006283480406257192, -0.038596303888500993], 3 =&gt; [0.03270978423950576, -0.010420372656952882], 1 =&gt; [0.015481499135407684, -0.007248727778316578]))</code></pre><p><strong>Show MNN and created behaviour:</strong></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; vis = Visualizer(net, behaviour=b)</code><code class="nohighlight hljs ansi" style="display:block;">Visualizer(Observable([0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 3.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0]), Observable([1.7320508075688772, 5.196152422706632, 8.660254037844386, 0.0, 3.4641016151377544, 6.928203230275509, 10.392304845413264, 1.7320508075688772, 5.196152422706632, 8.660254037844386, 0.0, 3.4641016151377544, 6.928203230275509, 10.392304845413264, 1.7320508075688772, 5.196152422706632, 8.660254037844386]), Tuple[(12, 15), (6, 10), (2, 5), (3, 7), (8, 15), (8, 12), (14, 17), (1, 4), (5, 9), (2, 6)  …  (10, 17), (13, 17), (5, 8), (10, 13), (10, 14), (3, 6), (5, 12), (13, 16), (1, 8), (2, 9)], Dict{Any, Observables.Observable}((10, 17, :ys) =&gt; Observable([8.660254037844386, 8.660254037844386]), (3, 10, :xs) =&gt; Observable([0.0, 2.0]), (6, 13, :xs) =&gt; Observable([1.0, 3.0]), (11, 15, :xs) =&gt; Observable([3.0, 4.0]), (5, 12, :ys) =&gt; Observable([3.4641016151377544, 3.4641016151377544]), (5, 8, :xs) =&gt; Observable([1.0, 2.0]), (1, 4, :ys) =&gt; Observable([1.7320508075688772, 0.0]), (5, 9, :ys) =&gt; Observable([3.4641016151377544, 5.196152422706632]), (2, 6, :ys) =&gt; Observable([5.196152422706632, 6.928203230275509]), (3, 6, :xs) =&gt; Observable([0.0, 1.0])…), Scene (1920px, 1080px):
  0 Plots
  1 Child Scene:
    └ Scene (1920px, 1080px), Axis (44 plots))</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><img src="../usageA_Visualization.svg" alt="Visualization of the MNN with the behaviours."/></p><p><strong>Simulate the behaviour:</strong></p><p>Keep the window of the last step open, then execute</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulate!(net, SecondOrderDiff(500), b, vis=vis)</code><code class="nohighlight hljs ansi" style="display:block;">retcode: Success
Interpolation: 3rd order Hermite
t: 388-element Vector{Float64}:
   0.0
   0.06847630724277075
   0.26901017909880315
   0.5501816432989028
   0.8921923079949878
   1.3226927404415574
   1.8388962310733303
   2.44266366390547
   3.131808456038284
   3.899399543895262
   ⋮
 488.6829687785675
 490.1250517579781
 491.5848303399554
 493.2278909744731
 494.7291140397738
 496.2166359230295
 497.6517851897346
 499.1300688005013
 500.0
u: 388-element Vector{RecursiveArrayTools.ArrayPartition{Float64, Tuple{Matrix{Float64}, Matrix{Float64}}}}:
 ([0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0], [0.0 0.0 … 4.0 4.0; 1.7320508075688772 5.196152422706632 … 5.196152422706632 8.660254037844386])
 ([0.0010531649204326597 -0.0004275997864662134 … -4.0022154507252105e-12 -7.326725194296225e-13; -0.0004932713474907728 -0.0026252551866955795 … 2.6060816870374745e-26 -1.9522317653753474e-27], [3.613599914369631e-5 -1.4669124320229619e-5 … 3.9999999999999525 3.999999999999991; 1.7320338852779582 5.196062339463391 … 5.196152422706632 8.660254037844386])
 ([0.004071017141899309 -0.0016612974059916864 … -3.6729220513620865e-9 -6.714675457924504e-10; -0.0019156381323424665 -0.010128587428359842 … 5.3047654255641105e-12 -5.21654490235929e-13], [0.000551365749646801 -0.0002243911849573738 … 3.99999999983334 3.9999999999695146; 1.7317920050079976 5.194779234149783 … 5.196152422706765 8.660254037844373])
 ([0.008202867719039853 -0.0034039000878329775 … -1.2806221459458484e-7 -2.329715292231808e-8; -0.003920268859689459 -0.020277401793074516 … 8.638412377008048e-10 -8.343435847976536e-11], [0.002278514696433719 -0.0009351682232946764 … 3.9999999881598223 3.9999999978423664; 1.7309729290598987 5.190495946575663 … 5.1961524227645475 8.66025403783876])
 ([0.013222683766287725 -0.005672460486527214 … -1.3937476224284412e-6 -2.509096667706554e-7; -0.006522571967481604 -0.03224667589273477 … 2.472029356784627e-8 -2.2971402122253447e-9], [0.00594006638307548 -0.0024805362550007876 … 3.999999790395856 3.9999999621028763; 1.7291947436085 5.181505847306302 … 5.196152425477838 8.660254037583398])
 ([0.01982365857405748 -0.008990677990216142 … -9.638125741383087e-6 -1.6994554173590788e-6; -0.010338977488821573 -0.04714026405225363 … 3.7195081160031223e-7 -3.2044069966416475e-8], [0.013035829185485787 -0.005613738265030006 … 3.9999978423555365 3.9999996158291062; 1.725592932377651 5.1644197205434805 … 5.196152485082903 8.660254032310037])
 ([0.028691759195721853 -0.014015944241849739 … -4.818937914752118e-5 -8.181368799331755e-6; -0.016232908614284246 -0.06550894376656016 … 3.533099248740258e-6 -2.6505327698056153e-7], [0.0254989463864399 -0.01149420285780196 … 3.999984940768213 3.99999739119077; 1.7188101713048143 5.135388298893851 … 5.196153252616793 8.660253971673285])
 ([0.04137233766464484 -0.021858521112985644 … -0.00019162338263337592 -3.0365686288441432e-5; -0.02591234499904561 -0.08898751624171365 … 2.4155295146569472e-5 -1.4124600508505644e-6], [0.04649411624852224 -0.022205291905405017 … 3.9999201789522294 3.9999868183524345; 1.7062684883817583 5.088891425049197 … 5.196160018510814 8.660253534580443])
 ([0.0606436379471748 -0.03375216325361525 … -0.0006393772128393056 -8.872305758976398e-5; -0.042387740795432276 -0.11977310695210733 … 0.00012783629263385266 -4.632984634790164e-6], [0.08129197294868869 -0.04119740175748044 … 3.999657799611947 3.999948140092117; 1.6831295371343356 5.0172071472309 … 5.196204378494746 8.660251552064324])
 ([0.09059071785905692 -0.04797022908805353 … -0.001852253213701904 -0.0001962832049624829; -0.07048657776051925 -0.15502167538489897 … 0.0005484755483247771 -5.223834004486147e-6], [0.1387032165914611 -0.07276518290419977 … 3.9987660221743844 3.999840702587035; 1.6405712404264081 4.911339512249349 … 5.196432009756684 8.660247031827156])
 ⋮
 ([5.638238713014346e-7 1.3779745336058236e-6 … -3.0722705983213325e-8 -4.155047582928545e-8; -2.4643593203751474e-8 9.424726043812945e-7 … -6.930562054256658e-8 -4.469159882567252e-9], [0.8392665616179668 0.6504712067360756 … 4.748956674376025 4.33004819744702; 1.4036782508303394 5.224177589394014 … 5.704445528045701 9.298088401448384])
 ([1.5742781796913187e-6 -2.5523286629929476e-6 … -1.4283135133292338e-7 1.0562084331437968e-7; -2.5062215541898833e-7 -4.188917221866113e-6 … -4.418119746047342e-7 -9.801857681714281e-9], [0.8392699209001581 0.650469365041703 … 4.748956402210497 4.330048298004611; 1.4036778159168222 5.224172490676795 … 5.7044447261843265 9.298088379201296])
 ([-2.805689483133573e-6 2.431368723312706e-6 … 2.351022089352093e-7 -1.1499191031834572e-7; 3.87339914252434e-7 5.211136770512611e-6 … 7.04801698001382e-7 1.8670411742260917e-8], [0.8392679433399657 0.6504691520412756 … 4.7489565503251745 4.330048283670027; 1.403678036446227 5.224174111775444 … 5.704445147267038 9.2980883929928])
 ([3.1801756839619716e-6 -1.8844136823798754e-6 … -2.5817529450600475e-7 1.0003141286438699e-7; -4.185771254542479e-7 -4.979301668325924e-6 … -7.629720704813375e-7 -2.0843634893013655e-8], [0.839268082766541 0.6504710831569493 … 4.748956557645924 4.330048218233505; 1.4036780694672186 5.224176037678976 … 5.704445194453508 9.298088392086353])
 ([-2.3050283840884396e-6 2.817427333202317e-7 … 1.774169925561314e-7 -3.4975880441943506e-8; 2.7440030444011616e-7 2.4531550995586783e-6 … 5.102344993712906e-7 1.4905855632514533e-8], [0.8392697952713445 0.6504681693914376 … 4.748956401461294 4.330048337896744; 1.40367779323056 5.224171332729978 … 5.70444470862132 9.29808838089429])
 ([4.963471135577854e-7 1.4124020660708807e-6 … -2.5210385842518466e-8 -4.347262533743048e-8; -1.706768374529795e-8 1.0418642986016782e-6 … -5.29182363764308e-8 -3.866227794592733e-9], [0.8392665850329837 0.6504710939337038 … 4.748956671218864 4.3300482014878705; 1.4036782448282081 5.224177447639876 … 5.704445518306636 9.29808840111916])
 ([1.6226477664876517e-6 -2.458411924414734e-6 … -1.4547246495108545e-7 1.0289586103609249e-7; -2.527853509329495e-7 -4.133658171485921e-6 … -4.4826216034145975e-7 -1.000392148478782e-8], [0.8392698644339027 0.6504694703495031 … 4.7489564073045765 4.330048293614598; 1.4036778252007553 5.224172656196297 … 5.704444742974101 9.298088379605304])
 ([-2.781780483008165e-6 2.2923902934583326e-6 … 2.321110164056206e-7 -1.0987430223922093e-7; 3.7979325199450734e-7 5.039670431595854e-6 … 6.939397874940282e-7 1.8515368761332214e-8], [0.8392679525418058 0.6504691433619316 … 4.748956549617993 4.330048283975517; 1.4036780350617315 5.22417409404772 … 5.704445145458649 9.298088393079775])
 ([6.126534424915369e-7 1.101489878463334e-6 … -3.627507021313464e-8 -3.142714548788802e-8; -4.3568733683098795e-8 5.995781102437769e-7 … -8.899778948258487e-8 -4.1408199816960376e-9], [0.8392668425964183 0.6504709391537923 … 4.748956650339278 4.33004820962251; 1.4036782088692614 5.224177042708463 … 5.704445457267713 9.298088400385854])</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><video src="../usageA_simulationBefore.mp4" controls="true" title="Video of the MNN being simulated with forces given in behaviour being applied. The end positions don&#39;t fit to the given goals."><a href="../usageA_simulationBefore.mp4">Video of the MNN being simulated with forces given in behaviour being applied. The end positions don&#39;t fit to the given goals.</a></video></p><p>You should now see the mass points (&quot;neurons&quot;) of the network settling into new stable positions according to the random spring constants set when you created the MNN and the forces randomly generated or set by you. This may take a while the first time because of precompilation, but should then be very fast in the same Julia session.</p><p>It should also be obvious that the neurons in the last column are far away from the set goal (except if you got really, really, really lucky).</p><p><strong>Creating a trainer:</strong></p><p>To optimize the spring constants, we need a <code>Trainer</code> object:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; t = Trainer([b], SecondOrderDiff(500), PPS())</code><code class="nohighlight hljs ansi" style="display:block;">Trainer(MNN.Deformation[MNN.Deformation(Dict{Int64, Vector{Number}}(15 =&gt; [0.3025607099234905, 0.16142535168476801], 16 =&gt; [-0.15248661383923434, 0.2781487141858242], 17 =&gt; [-0.3031678143123898, -0.061941962381140137]), true, Dict{Int64, Vector{Number}}(2 =&gt; [-0.006283480406257192, -0.038596303888500993], 3 =&gt; [0.03270978423950576, -0.010420372656952882], 1 =&gt; [0.015481499135407684, -0.007248727778316578]))], SecondOrderDiff(500, MNN.var&quot;#29#30&quot;()), PPS(false, 1.15, 1.0, Set{Any}(), 250))</code></pre><p><strong>Training:</strong></p><p>Now we train for 500 Epochs:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; train!(net, 500, t)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Base loss: 0.5886115437079231
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 480, base loss: 0.0660525490364857, loss: 0.06611180524448947, increment: 1.0
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 460, base loss: 0.024065563936855428, loss: 0.33328576254657555, increment: -1.0
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 440, base loss: 0.01887574913347735, loss: 0.01887574913347735, increment: -1.0
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 420, base loss: 0.01215702766971364, loss: 0.018076882808157564, increment: 0.9
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 400, base loss: 0.006170736273913725, loss: 0.006364716721041834, increment: -0.9
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 380, base loss: 0.006168753069424923, loss: 0.2507048932220532, increment: -0.9
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 360, base loss: 0.0061063235303888234, loss: 0.0061063235303888234, increment: 0.81
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 340, base loss: 0.005670939133558054, loss: 0.2376321676158253, increment: 0.81
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 320, base loss: 0.005670450200509585, loss: 0.3058734490967045, increment: -0.81
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 300, base loss: 0.00555351381165541, loss: 0.06569240078090455, increment: 0.7290000000000001
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 280, base loss: 0.005248094283381682, loss: 0.00583408364266171, increment: 0.7290000000000001
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 260, base loss: 0.005101197190479145, loss: 0.020532050235546776, increment: -0.7290000000000001
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 240, base loss: 0.005085394389047759, loss: 0.005086764886473458, increment: 0.6561000000000001
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 220, base loss: 0.004870076639784692, loss: 0.9218638490231786, increment: 0.6561000000000001
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 200, base loss: 0.004614224160372617, loss: 0.004614224160372617, increment: -0.6561000000000001
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 180, base loss: 0.004558617267216185, loss: 0.004559841656358469, increment: -0.6561000000000001
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 160, base loss: 0.004485512533255919, loss: 0.004485512533255919, increment: 0.5904900000000002
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 140, base loss: 0.004336231897443986, loss: 0.0044049025259061125, increment: -0.5904900000000002
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 120, base loss: 0.0037512342595272074, loss: 0.5949544372662036, increment: -0.5904900000000002
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 100, base loss: 0.0035506219362507266, loss: 0.6179985750145612, increment: 0.5314410000000002
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 80, base loss: 0.002623729464869238, loss: 0.3698844041720059, increment: -0.5314410000000002
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 60, base loss: 0.0025091286344806484, loss: 0.018581212506869327, increment: -0.5314410000000002
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 40, base loss: 0.002274243363536248, loss: 0.002274243363536248, increment: 0.47829690000000014
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 20, base loss: 0.0021664211845631005, loss: 0.16904141241677031, increment: 0.47829690000000014
<span class="sgr36"><span class="sgr1">[ Info: </span></span>Epochs left: 0, base loss: 0.0021664211845631005, loss: 0.02134290630131222, increment: -0.47829690000000014</code></pre><p>Ideally, the base loss (the best loss so far) will decrease significantly.</p><p>If it hasn&#39;t, try executing the previous command again to train the MNN more.</p><p>If that still doesn&#39;t get satisfactory results, then maybe the goals and/or forces you set using the GUI were too large.</p><p><strong>Testing:</strong></p><p>Now check if the MNN fits the given shape morphing behaviour better:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; vis = Visualizer(net, behaviour=b); # update visualization of spring constants</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; reset!(net, vis=vis) # reset neuron positions</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; simulate!(net, SecondOrderDiff(500), b, vis=vis)</code><code class="nohighlight hljs ansi" style="display:block;">retcode: Success
Interpolation: 3rd order Hermite
t: 1009-element Vector{Float64}:
   0.0
   0.06847630724277075
   0.1828031562311085
   0.3175051981169265
   0.49120753910740234
   0.7070037696236923
   0.9900591147648212
   1.263982829372197
   1.5930137904095178
   1.9494914369356937
   ⋮
 496.1063559823855
 496.5681259111204
 497.0621216491589
 497.6011793122287
 498.0875246848164
 498.5703734409723
 499.1023260087633
 499.59565970744967
 500.0
u: 1009-element Vector{RecursiveArrayTools.ArrayPartition{Float64, Tuple{Matrix{Float64}, Matrix{Float64}}}}:
 ([0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0], [0.0 0.0 … 4.0 4.0; 1.7320508075688772 5.196152422706632 … 5.196152422706632 8.660254037844386])
 ([0.0010528102711602784 -0.0004271145875253347 … -7.909766864677368e-10 8.736347043392049e-10; -0.0004929377997555202 -0.0026206659710827454 … 3.395014984356032e-23 1.8361211223052426e-23], [3.612992191371751e-5 -1.4660807137507167e-5 … 3.9999999999906253 4.000000000010354; 1.7320338909995312 5.196062418154155 … 5.196152422706632 8.660254037844386])
 ([0.0027774173399892675 -0.0011237133683748752 … -1.0520594225709393e-7 1.1631734968854767e-7; -0.001300399794836253 -0.006848588478135404 … 1.9364924245630696e-10 -3.2550213442965944e-10], [0.0002554789748151881 -0.00010352791316830183 … 3.999999996769666 4.000000003570312; 1.7319311911767172 5.195518979412716 … 5.196152422710621 8.660254037837682])
 ([0.004754130423440785 -0.0019113219159657847 … -1.6134671987273293e-6 1.7876719198257266e-6; -0.0022270016597877194 -0.011467698758888346 … 9.225158738080897e-9 -1.5541087200251464e-8], [0.0007634249408322694 -0.00030838839986869733 … 3.999999913648627 4.000000095595583; 1.731693324328122 5.194280146712556 … 5.196152423071793 8.660254037229654])
 ([0.007208218308304746 -0.002860436999706124 … -1.3575036311441065e-5 1.5110504838701741e-5; -0.0033873401725491997 -0.01661876199288972 … 1.8608170262196712e-7 -3.1485156484905804e-7], [0.0018039913930299448 -0.000724018531063068 … 3.9999988635911397 4.000001262347221; 1.7312052244305143 5.191826018112764 … 5.196152434303263 8.660254018253601])
 ([0.010087788158285623 -0.003910888330221942 … -7.696315185646289e-5 8.647796410353582e-5; -0.0047981293269237545 -0.02144311057804421 … 2.1878556592347484e-6 -3.7311073421479274e-6], [0.0036738326138599006 -0.0014574311105978277 … 3.9999905439054624 4.000010574966704; 1.7303217520013252 5.187685518534052 … 5.19615262237805 8.660253698401384])
 ([0.013524674756774114 -0.005032519555199422 … -0.0003571782909297178 0.00040958412435487785; -0.006670098532903189 -0.024849809697281504 … 1.995615754021506e-5 -3.4517571449648216e-5], [0.007025555734459251 -0.0027304380059492823 … 3.99993630982609 4.000072235582234; 1.7287002955703292 5.1810553919268365 … 5.196155046711072 8.66024952640867])
 ([0.01642520788411596 -0.005817454825212285 … -0.0010081610261653165 0.0011925504754657164; -0.008572320722283018 -0.02518183121873772 … 9.208105686881019e-5 -0.00016202147655774182], [0.01113750263834347 -0.004223294483690285 … 3.9997596711129404 4.000278289257784; 1.7266149319461022 5.174142461699292 … 5.196168445538684 8.660226108275907])
 ([0.019348420319779326 -0.006368001910451291 … -0.0024430288117100627 0.0030566001485320383; -0.010923333787109354 -0.022679478724549933 … 0.000355946001208575 -0.0006410292936573136], [0.01703872885166683 -0.006239682804731763 … 3.999212017003775 4.000946086124478; 1.723406915530897 5.166200158845317 … 5.1962349194738895 8.660107491433246])
 ([0.021951155362892254 -0.006473533137547529 … -0.004715815682718275 0.006435375891896367; -0.013222747091360856 -0.018164342358618257 … 0.0010304553753334035 -0.0019014946213466073], [0.024414374173320954 -0.008544074695664972 … 3.9979535524896614 4.0025950033217725; 1.7190884531924586 5.158895308095926 … 5.196467612518841 8.659682249951807])
 ⋮
 ([3.404822374559757e-6 -1.2541763512868502e-5 … -3.935999414970351e-6 2.466310139865721e-6; 3.7420598611173273e-6 5.4517242582961e-7 … -1.1332511465813895e-6 2.0380543051261966e-6], [0.16407016531013954 0.007501237472387872 … 3.8652240091458925 3.7218389270316696; 1.7206925380004439 4.520345465773195 … 5.4408859806247545 8.562845819568453])
 ([2.6683898640253947e-6 -9.829205294822409e-6 … -3.08462538188809e-6 1.932868164680521e-6; 2.9327199356567405e-6 4.2730221650186486e-7 … -8.881379380606262e-7 1.5972494909368605e-6], [0.16407227749792125 0.00749345696350011 … 3.865221567385051 3.7218404570555697; 1.7206948594795854 4.52034580398306 … 5.440885277591011 8.562847083914972])
 ([-5.230171739673986e-6 1.926706458616428e-5 … 6.046823898194334e-6 -3.788962774128757e-6; -5.74888375364835e-6 -8.37338048936873e-7 … 1.7408650258049534e-6 -3.130986597779331e-6], [0.16407125701191688 0.007497216403387488 … 3.8652227473021465 3.7218397177250546; 1.7206937377180878 4.520345640626061 … 5.440885617280554 8.56284647297844])
 ([3.2234023006472736e-6 -1.1874082389029765e-5 … -3.7264757127155305e-6 2.335004290495865e-6; 3.542943711605943e-6 5.161366179556115e-7 … -1.0731406958237053e-6 1.9296345924986032e-6], [0.1640701875507665 0.007501156179161541 … 3.865223983781839 3.7218389429276795; 1.7206925621726168 4.5203454694290475 … 5.440885973176452 8.562845832754796])
 ([2.2073104744044223e-6 -8.131215976032813e-6 … -2.551788916152567e-6 1.599036739097647e-6; 2.4261979318093416e-6 3.5346552346129034e-7 … -7.347328498125288e-7 1.321510623670942e-6], [0.1640722998306791 0.007493375070868354 … 3.865221541810393 3.7218404730863504; 1.720694883883811 4.520345807652926 … 5.44088527001651 8.562847097264054])
 ([-5.072198503146634e-6 1.8684581860147174e-5 … 5.86396472340711e-6 -3.674338996764776e-6; -5.574998948225788e-6 -8.120459427595646e-7 … 1.6884199191969645e-6 -3.036125016668204e-6], [0.16407120750901988 0.007497398880218251 … 3.8652228046714217 3.7218396818122406; 1.7206936832926494 4.520345632789445 … 5.4408856336444975 8.562846443468986])
 ([3.1597520281288196e-6 -1.1640185583951847e-5 … -3.653214279869659e-6 2.2889825562512404e-6; 3.473206355193397e-6 5.059864476644298e-7 … -1.051953216439426e-6 1.8917102820799657e-6], [0.16407023107646718 0.007500995654424578 … 3.8652239334541894 3.7218389744806504; 1.7206926101240518 4.520345476494233 … 5.440885958627616 8.56284585906494])
 ([1.9509585281840306e-6 -7.1872521672544966e-6 … -2.255653418296597e-6 1.4133863158593502e-6; 2.1446080716072328e-6 3.1247970674194686e-7 … -6.494788292334848e-7 1.1681174683937718e-6], [0.16407228505069965 0.007493429089793213 … 3.8652215587433596 3.7218404624319357; 1.7206948678480687 4.520345805408838 … 5.440885274844847 8.56284708872961])
 ([-4.668103629668901e-6 1.7195817536837277e-5 … 5.396752245512421e-6 -3.3815138693894932e-6; -5.130696736964921e-6 -7.473012155125183e-7 … 1.5539627564075328e-6 -2.79422106608526e-6], [0.1640715340699438 0.007496195375796288 … 3.8652224269171054 3.721839918456172; 1.7206940425023742 4.520345685216793 … 5.440885524833455 8.562846639266523])</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p><video src="../usageA_simulationAfter.mp4" controls="true" title="Video of the MNN being simulated with forces given in behaviour being applied. The end positions now fit much better to the given goals."><a href="../usageA_simulationAfter.mp4">Video of the MNN being simulated with forces given in behaviour being applied. The end positions now fit much better to the given goals.</a></video></p><p>As you can (hopefully) see, the end positions of the neurons now fit much better. The values of the spring constants probably also changed significantly. You can see this by looking at the colors of the springs (lines between neurons): Red means positive spring constant and blue means negative constant.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../customize-simulation/">Adding Your Own Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Sunday 30 March 2025 11:50">Sunday 30 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
